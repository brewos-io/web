---
interface Props {
  url?: string;
  title?: string;
  description?: string;
}

const siteUrl = 'https://brewos.io';
const { 
  url = typeof window !== 'undefined' ? window.location.href : siteUrl,
  title = 'BrewOS - Open Source Espresso Machine Firmware',
  description = 'Transform your espresso machine with precise PID temperature control, WiFi monitoring, and OTA updates.'
} = Astro.props;

const encodedUrl = encodeURIComponent(url);
const encodedTitle = encodeURIComponent(title);
const encodedDescription = encodeURIComponent(description);

const shareLinks = {
  twitter: `https://twitter.com/intent/tweet?url=${encodedUrl}&text=${encodedTitle}`,
  reddit: `https://reddit.com/submit?url=${encodedUrl}&title=${encodedTitle}`,
  hackernews: `https://news.ycombinator.com/submitlink?u=${encodedUrl}&t=${encodedTitle}`,
  linkedin: `https://www.linkedin.com/sharing/share-offsite/?url=${encodedUrl}`,
  email: `mailto:?subject=${encodedTitle}&body=${encodedDescription}%20${encodedUrl}`
};

const copyToClipboard = () => {
  if (typeof navigator !== 'undefined' && navigator.clipboard) {
    navigator.clipboard.writeText(url);
    // Show feedback
    const button = document.querySelector('.share-copy');
    if (button) {
      const originalText = button.textContent;
      button.textContent = 'Copied!';
      setTimeout(() => {
        button.textContent = originalText;
      }, 2000);
    }
  }
};
---

<div class="social-share">
  <span class="share-label">Share:</span>
  <div class="share-buttons">
    <a 
      href={shareLinks.twitter}
      target="_blank"
      rel="noopener noreferrer"
      class="share-button share-twitter"
      aria-label="Share on Twitter (opens in new tab)"
      title="Share on Twitter"
    >
      <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
        <path d="M23 3a10.9 10.9 0 01-3.14 1.53 4.48 4.48 0 00-7.86 3v1A10.66 10.66 0 013 4s-4 9 5 13a11.64 11.64 0 01-7 2c9 5 20 0 20-11.5a4.5 4.5 0 00-.08-.83A7.72 7.72 0 0023 3z"/>
      </svg>
      <span class="sr-only">Twitter</span>
    </a>
    
    <a 
      href={shareLinks.reddit}
      target="_blank"
      rel="noopener noreferrer"
      class="share-button share-reddit"
      aria-label="Share on Reddit (opens in new tab)"
      title="Share on Reddit"
    >
      <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
        <path d="M12 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0zm5.01 4.744c.688 0 1.25.561 1.25 1.249a1.25 1.25 0 0 1-2.498.056l-2.597-2.597a1.25 1.25 0 0 1 0-1.768l2.597-2.597a1.25 1.25 0 0 1 1.768 0l2.597 2.597a1.25 1.25 0 0 1 0 1.768l-2.597 2.597zm-10.02 0a1.25 1.25 0 0 1 0-1.768l2.597-2.597a1.25 1.25 0 0 1 1.768 0l2.597 2.597a1.25 1.25 0 0 1 0 1.768l-2.597 2.597a1.25 1.25 0 0 1-1.768 0L6.99 5.512a1.25 1.25 0 0 1 0-1.768zM12 5.118l-3.124 3.124a1.25 1.25 0 0 1 0 1.768l3.124 3.124a1.25 1.25 0 0 1 1.768 0l3.124-3.124a1.25 1.25 0 0 1 0-1.768L12 5.118zm5.01 7.132a1.25 1.25 0 0 1 1.768 0l2.597 2.597a1.25 1.25 0 0 1 0 1.768l-2.597 2.597a1.25 1.25 0 0 1-1.768 0l-2.597-2.597a1.25 1.25 0 0 1 0-1.768l2.597-2.597zm-10.02 0a1.25 1.25 0 0 1 0 1.768l-2.597 2.597a1.25 1.25 0 0 1-1.768 0L2.99 15.015a1.25 1.25 0 0 1 0-1.768l2.597-2.597a1.25 1.25 0 0 1 1.768 0l2.597 2.597z"/>
      </svg>
      <span class="sr-only">Reddit</span>
    </a>
    
    <a 
      href={shareLinks.hackernews}
      target="_blank"
      rel="noopener noreferrer"
      class="share-button share-hn"
      aria-label="Share on Hacker News (opens in new tab)"
      title="Share on Hacker News"
    >
      <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
        <path d="M0 0v24h24V0H0zm1.946 4.751h20.108v14.498H1.946V4.751zm2.465 2.465v9.568h15.178V7.216H4.411zm2.465 2.465h10.248v4.638H6.876V9.681zm1.753 1.753v1.132h6.742V11.434H8.629z"/>
      </svg>
      <span class="sr-only">Hacker News</span>
    </a>
    
    <button 
      type="button"
      class="share-button share-copy"
      onclick={copyToClipboard}
      aria-label="Copy link to clipboard"
      title="Copy link"
    >
      <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
        <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
        <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
      </svg>
      <span class="share-copy-text">Copy Link</span>
    </button>
  </div>
</div>

<style>
  .social-share {
    display: flex;
    align-items: center;
    gap: 12px;
    flex-wrap: wrap;
  }

  .share-label {
    font-size: 0.9rem;
    font-weight: 600;
    color: var(--text-secondary);
  }

  .share-buttons {
    display: flex;
    gap: 8px;
    align-items: center;
  }

  .share-button {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 40px;
    height: 40px;
    border-radius: 8px;
    background: var(--cream-200);
    color: var(--coffee-600);
    text-decoration: none;
    border: 1px solid var(--cream-300);
    transition: all 0.2s ease;
    cursor: pointer;
    padding: 0;
  }

  .share-button:hover {
    background: var(--cream-300);
    border-color: var(--accent);
    color: var(--accent);
    transform: translateY(-2px);
  }

  .share-button svg {
    width: 18px;
    height: 18px;
  }

  .share-twitter:hover {
    background: #1DA1F2;
    border-color: #1DA1F2;
    color: white;
  }

  .share-reddit:hover {
    background: #FF4500;
    border-color: #FF4500;
    color: white;
  }

  .share-hn:hover {
    background: #FF6600;
    border-color: #FF6600;
    color: white;
  }

  .share-copy {
    position: relative;
  }

  .share-copy-text {
    position: absolute;
    left: 50%;
    transform: translateX(-50%);
    bottom: -28px;
    font-size: 0.75rem;
    white-space: nowrap;
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.2s ease;
    background: var(--coffee-800);
    color: var(--white);
    padding: 4px 8px;
    border-radius: 4px;
  }

  .share-button:hover .share-copy-text {
    opacity: 1;
  }

  @media (max-width: 768px) {
    .social-share {
      justify-content: center;
    }

    .share-label {
      width: 100%;
      text-align: center;
    }
  }
</style>

