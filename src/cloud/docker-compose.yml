# Fixed project name ensures consistent volume naming across deployments
# Without this, Docker Compose uses the directory name which can vary
name: brewos

services:
  brewos-cloud:
    build: .
    ports:
      - "3001:3001"
    volumes:
      - brewos-data:/data
      - ../web/dist:/app/web:ro
    environment:
      - PORT=3001
      - DATA_DIR=/data
      - WEB_DIST_PATH=/app/web
      - GOOGLE_CLIENT_ID=${GOOGLE_CLIENT_ID}
      - TRUST_PROXY=${TRUST_PROXY:-false}
    restart: unless-stopped
    # Allow time for database to save on shutdown
    stop_grace_period: 30s

volumes:
  brewos-data:
